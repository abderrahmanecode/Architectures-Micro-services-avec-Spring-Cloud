{"ast":null,"code":"import _asyncToGenerator from \"D:/Abdo files/TP3_MS/ecom-web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport { HttpHeaders, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Subject, from, combineLatest } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport Keycloak from 'keycloak-js';\nimport { CommonModule } from '@angular/common';\nvar KeycloakEventType;\n(function (KeycloakEventType) {\n  KeycloakEventType[KeycloakEventType[\"OnAuthError\"] = 0] = \"OnAuthError\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthLogout\"] = 1] = \"OnAuthLogout\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthRefreshError\"] = 2] = \"OnAuthRefreshError\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthRefreshSuccess\"] = 3] = \"OnAuthRefreshSuccess\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthSuccess\"] = 4] = \"OnAuthSuccess\";\n  KeycloakEventType[KeycloakEventType[\"OnReady\"] = 5] = \"OnReady\";\n  KeycloakEventType[KeycloakEventType[\"OnTokenExpired\"] = 6] = \"OnTokenExpired\";\n  KeycloakEventType[KeycloakEventType[\"OnActionUpdate\"] = 7] = \"OnActionUpdate\";\n})(KeycloakEventType || (KeycloakEventType = {}));\nclass KeycloakAuthGuard {\n  constructor(router, keycloakAngular) {\n    this.router = router;\n    this.keycloakAngular = keycloakAngular;\n  }\n  canActivate(route, state) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        _this.authenticated = yield _this.keycloakAngular.isLoggedIn();\n        _this.roles = yield _this.keycloakAngular.getUserRoles(true);\n        return yield _this.isAccessAllowed(route, state);\n      } catch (error) {\n        throw new Error('An error happened during access validation. Details:' + error);\n      }\n    })();\n  }\n}\nclass KeycloakService {\n  constructor() {\n    this._keycloakEvents$ = new Subject();\n  }\n  bindsKeycloakEvents() {\n    this._instance.onAuthError = errorData => {\n      this._keycloakEvents$.next({\n        args: errorData,\n        type: KeycloakEventType.OnAuthError\n      });\n    };\n    this._instance.onAuthLogout = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthLogout\n      });\n    };\n    this._instance.onAuthRefreshSuccess = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthRefreshSuccess\n      });\n    };\n    this._instance.onAuthRefreshError = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthRefreshError\n      });\n    };\n    this._instance.onAuthSuccess = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthSuccess\n      });\n    };\n    this._instance.onTokenExpired = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnTokenExpired\n      });\n    };\n    this._instance.onActionUpdate = state => {\n      this._keycloakEvents$.next({\n        args: state,\n        type: KeycloakEventType.OnActionUpdate\n      });\n    };\n    this._instance.onReady = authenticated => {\n      this._keycloakEvents$.next({\n        args: authenticated,\n        type: KeycloakEventType.OnReady\n      });\n    };\n  }\n  loadExcludedUrls(bearerExcludedUrls) {\n    const excludedUrls = [];\n    for (const item of bearerExcludedUrls) {\n      let excludedUrl;\n      if (typeof item === 'string') {\n        excludedUrl = {\n          urlPattern: new RegExp(item, 'i'),\n          httpMethods: []\n        };\n      } else {\n        excludedUrl = {\n          urlPattern: new RegExp(item.url, 'i'),\n          httpMethods: item.httpMethods\n        };\n      }\n      excludedUrls.push(excludedUrl);\n    }\n    return excludedUrls;\n  }\n  initServiceValues({\n    enableBearerInterceptor = true,\n    loadUserProfileAtStartUp = false,\n    bearerExcludedUrls = [],\n    authorizationHeaderName = 'Authorization',\n    bearerPrefix = 'Bearer',\n    initOptions,\n    updateMinValidity = 20,\n    shouldAddToken = () => true,\n    shouldUpdateToken = () => true\n  }) {\n    this._enableBearerInterceptor = enableBearerInterceptor;\n    this._loadUserProfileAtStartUp = loadUserProfileAtStartUp;\n    this._authorizationHeaderName = authorizationHeaderName;\n    this._bearerPrefix = bearerPrefix.trim().concat(' ');\n    this._excludedUrls = this.loadExcludedUrls(bearerExcludedUrls);\n    this._silentRefresh = initOptions ? initOptions.flow === 'implicit' : false;\n    this._updateMinValidity = updateMinValidity;\n    this.shouldAddToken = shouldAddToken;\n    this.shouldUpdateToken = shouldUpdateToken;\n  }\n  init(options = {}) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.initServiceValues(options);\n      const {\n        config,\n        initOptions\n      } = options;\n      _this2._instance = new Keycloak(config);\n      _this2.bindsKeycloakEvents();\n      const authenticated = yield _this2._instance.init(initOptions);\n      if (authenticated && _this2._loadUserProfileAtStartUp) {\n        yield _this2.loadUserProfile();\n      }\n      return authenticated;\n    })();\n  }\n  login(options = {}) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      yield _this3._instance.login(options);\n      if (_this3._loadUserProfileAtStartUp) {\n        yield _this3.loadUserProfile();\n      }\n    })();\n  }\n  logout(redirectUri) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const options = {\n        redirectUri\n      };\n      yield _this4._instance.logout(options);\n      _this4._userProfile = undefined;\n    })();\n  }\n  register(options = {\n    action: 'register'\n  }) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      yield _this5._instance.register(options);\n    })();\n  }\n  isUserInRole(role, resource) {\n    let hasRole;\n    hasRole = this._instance.hasResourceRole(role, resource);\n    if (!hasRole) {\n      hasRole = this._instance.hasRealmRole(role);\n    }\n    return hasRole;\n  }\n  getUserRoles(allRoles = true) {\n    let roles = [];\n    if (this._instance.resourceAccess) {\n      for (const key in this._instance.resourceAccess) {\n        if (this._instance.resourceAccess.hasOwnProperty(key)) {\n          const resourceAccess = this._instance.resourceAccess[key];\n          const clientRoles = resourceAccess['roles'] || [];\n          roles = roles.concat(clientRoles);\n        }\n      }\n    }\n    if (allRoles && this._instance.realmAccess) {\n      const realmRoles = this._instance.realmAccess['roles'] || [];\n      roles.push(...realmRoles);\n    }\n    return roles;\n  }\n  isLoggedIn() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this6._instance) {\n        return false;\n      }\n      return _this6._instance.authenticated;\n    })();\n  }\n  isTokenExpired(minValidity = 0) {\n    return this._instance.isTokenExpired(minValidity);\n  }\n  updateToken(minValidity = this._updateMinValidity) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      if (_this7._silentRefresh) {\n        if (_this7.isTokenExpired()) {\n          throw new Error('Failed to refresh the token, or the session is expired');\n        }\n        return true;\n      }\n      if (!_this7._instance) {\n        throw new Error('Keycloak Angular library is not initialized.');\n      }\n      try {\n        return yield _this7._instance.updateToken(minValidity);\n      } catch (error) {\n        return false;\n      }\n    })();\n  }\n  loadUserProfile(forceReload = false) {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      if (_this8._userProfile && !forceReload) {\n        return _this8._userProfile;\n      }\n      if (!_this8._instance.authenticated) {\n        throw new Error('The user profile was not loaded as the user is not logged in.');\n      }\n      return _this8._userProfile = yield _this8._instance.loadUserProfile();\n    })();\n  }\n  getToken() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      return _this9._instance.token;\n    })();\n  }\n  getUsername() {\n    if (!this._userProfile) {\n      throw new Error('User not logged in or user profile was not loaded.');\n    }\n    return this._userProfile.username;\n  }\n  clearToken() {\n    this._instance.clearToken();\n  }\n  addTokenToHeader(headers = new HttpHeaders()) {\n    return from(this.getToken()).pipe(map(token => token ? headers.set(this._authorizationHeaderName, this._bearerPrefix + token) : headers));\n  }\n  getKeycloakInstance() {\n    return this._instance;\n  }\n  get excludedUrls() {\n    return this._excludedUrls;\n  }\n  get enableBearerInterceptor() {\n    return this._enableBearerInterceptor;\n  }\n  get keycloakEvents$() {\n    return this._keycloakEvents$;\n  }\n}\nKeycloakService.ɵfac = function KeycloakService_Factory(t) {\n  return new (t || KeycloakService)();\n};\nKeycloakService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: KeycloakService,\n  factory: KeycloakService.ɵfac\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(KeycloakService, [{\n    type: Injectable\n  }], null, null);\n})();\nclass KeycloakBearerInterceptor {\n  constructor(keycloak) {\n    this.keycloak = keycloak;\n  }\n  conditionallyUpdateToken(req) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      if (_this10.keycloak.shouldUpdateToken(req)) {\n        return yield _this10.keycloak.updateToken();\n      }\n      return true;\n    })();\n  }\n  isUrlExcluded({\n    method,\n    url\n  }, {\n    urlPattern,\n    httpMethods\n  }) {\n    const httpTest = httpMethods.length === 0 || httpMethods.join().indexOf(method.toUpperCase()) > -1;\n    const urlTest = urlPattern.test(url);\n    return httpTest && urlTest;\n  }\n  intercept(req, next) {\n    const {\n      enableBearerInterceptor,\n      excludedUrls\n    } = this.keycloak;\n    if (!enableBearerInterceptor) {\n      return next.handle(req);\n    }\n    const shallPass = !this.keycloak.shouldAddToken(req) || excludedUrls.findIndex(item => this.isUrlExcluded(req, item)) > -1;\n    if (shallPass) {\n      return next.handle(req);\n    }\n    return combineLatest([this.conditionallyUpdateToken(req), this.keycloak.isLoggedIn()]).pipe(mergeMap(([_, isLoggedIn]) => isLoggedIn ? this.handleRequestWithTokenHeader(req, next) : next.handle(req)));\n  }\n  handleRequestWithTokenHeader(req, next) {\n    return this.keycloak.addTokenToHeader(req.headers).pipe(mergeMap(headersWithBearer => {\n      const kcReq = req.clone({\n        headers: headersWithBearer\n      });\n      return next.handle(kcReq);\n    }));\n  }\n}\nKeycloakBearerInterceptor.ɵfac = function KeycloakBearerInterceptor_Factory(t) {\n  return new (t || KeycloakBearerInterceptor)(i0.ɵɵinject(KeycloakService));\n};\nKeycloakBearerInterceptor.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: KeycloakBearerInterceptor,\n  factory: KeycloakBearerInterceptor.ɵfac\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(KeycloakBearerInterceptor, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: KeycloakService\n    }];\n  }, null);\n})();\nclass CoreModule {}\nCoreModule.ɵfac = function CoreModule_Factory(t) {\n  return new (t || CoreModule)();\n};\nCoreModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: CoreModule\n});\nCoreModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  providers: [KeycloakService, {\n    provide: HTTP_INTERCEPTORS,\n    useClass: KeycloakBearerInterceptor,\n    multi: true\n  }],\n  imports: [CommonModule]\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CoreModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule],\n      providers: [KeycloakService, {\n        provide: HTTP_INTERCEPTORS,\n        useClass: KeycloakBearerInterceptor,\n        multi: true\n      }]\n    }]\n  }], null, null);\n})();\nclass KeycloakAngularModule {}\nKeycloakAngularModule.ɵfac = function KeycloakAngularModule_Factory(t) {\n  return new (t || KeycloakAngularModule)();\n};\nKeycloakAngularModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: KeycloakAngularModule\n});\nKeycloakAngularModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  imports: [CoreModule]\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(KeycloakAngularModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CoreModule]\n    }]\n  }], null, null);\n})();\nexport { CoreModule, KeycloakAngularModule, KeycloakAuthGuard, KeycloakBearerInterceptor, KeycloakEventType, KeycloakService };","map":{"version":3,"names":["i0","Injectable","NgModule","HttpHeaders","HTTP_INTERCEPTORS","Subject","from","combineLatest","map","mergeMap","Keycloak","CommonModule","KeycloakEventType","KeycloakAuthGuard","constructor","router","keycloakAngular","canActivate","route","state","authenticated","isLoggedIn","roles","getUserRoles","isAccessAllowed","error","Error","KeycloakService","_keycloakEvents$","bindsKeycloakEvents","_instance","onAuthError","errorData","next","args","type","OnAuthError","onAuthLogout","OnAuthLogout","onAuthRefreshSuccess","OnAuthRefreshSuccess","onAuthRefreshError","OnAuthRefreshError","onAuthSuccess","OnAuthSuccess","onTokenExpired","OnTokenExpired","onActionUpdate","OnActionUpdate","onReady","OnReady","loadExcludedUrls","bearerExcludedUrls","excludedUrls","item","excludedUrl","urlPattern","RegExp","httpMethods","url","push","initServiceValues","enableBearerInterceptor","loadUserProfileAtStartUp","authorizationHeaderName","bearerPrefix","initOptions","updateMinValidity","shouldAddToken","shouldUpdateToken","_enableBearerInterceptor","_loadUserProfileAtStartUp","_authorizationHeaderName","_bearerPrefix","trim","concat","_excludedUrls","_silentRefresh","flow","_updateMinValidity","init","options","config","loadUserProfile","login","logout","redirectUri","_userProfile","undefined","register","action","isUserInRole","role","resource","hasRole","hasResourceRole","hasRealmRole","allRoles","resourceAccess","key","hasOwnProperty","clientRoles","realmAccess","realmRoles","isTokenExpired","minValidity","updateToken","forceReload","getToken","token","getUsername","username","clearToken","addTokenToHeader","headers","pipe","set","getKeycloakInstance","keycloakEvents$","ɵfac","ɵprov","KeycloakBearerInterceptor","keycloak","conditionallyUpdateToken","req","isUrlExcluded","method","httpTest","length","join","indexOf","toUpperCase","urlTest","test","intercept","handle","shallPass","findIndex","_","handleRequestWithTokenHeader","headersWithBearer","kcReq","clone","CoreModule","ɵmod","ɵinj","provide","useClass","multi","imports","providers","KeycloakAngularModule"],"sources":["D:/Abdo files/TP3_MS/ecom-web-app/node_modules/keycloak-angular/fesm2020/keycloak-angular.mjs"],"sourcesContent":["import * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport { HttpHeaders, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Subject, from, combineLatest } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport Keycloak from 'keycloak-js';\nimport { CommonModule } from '@angular/common';\n\nvar KeycloakEventType;\n(function (KeycloakEventType) {\n    KeycloakEventType[KeycloakEventType[\"OnAuthError\"] = 0] = \"OnAuthError\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthLogout\"] = 1] = \"OnAuthLogout\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthRefreshError\"] = 2] = \"OnAuthRefreshError\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthRefreshSuccess\"] = 3] = \"OnAuthRefreshSuccess\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthSuccess\"] = 4] = \"OnAuthSuccess\";\n    KeycloakEventType[KeycloakEventType[\"OnReady\"] = 5] = \"OnReady\";\n    KeycloakEventType[KeycloakEventType[\"OnTokenExpired\"] = 6] = \"OnTokenExpired\";\n    KeycloakEventType[KeycloakEventType[\"OnActionUpdate\"] = 7] = \"OnActionUpdate\";\n})(KeycloakEventType || (KeycloakEventType = {}));\n\nclass KeycloakAuthGuard {\n    constructor(router, keycloakAngular) {\n        this.router = router;\n        this.keycloakAngular = keycloakAngular;\n    }\n    async canActivate(route, state) {\n        try {\n            this.authenticated = await this.keycloakAngular.isLoggedIn();\n            this.roles = await this.keycloakAngular.getUserRoles(true);\n            return await this.isAccessAllowed(route, state);\n        }\n        catch (error) {\n            throw new Error('An error happened during access validation. Details:' + error);\n        }\n    }\n}\n\nclass KeycloakService {\n    constructor() {\n        this._keycloakEvents$ = new Subject();\n    }\n    bindsKeycloakEvents() {\n        this._instance.onAuthError = (errorData) => {\n            this._keycloakEvents$.next({\n                args: errorData,\n                type: KeycloakEventType.OnAuthError\n            });\n        };\n        this._instance.onAuthLogout = () => {\n            this._keycloakEvents$.next({ type: KeycloakEventType.OnAuthLogout });\n        };\n        this._instance.onAuthRefreshSuccess = () => {\n            this._keycloakEvents$.next({\n                type: KeycloakEventType.OnAuthRefreshSuccess\n            });\n        };\n        this._instance.onAuthRefreshError = () => {\n            this._keycloakEvents$.next({\n                type: KeycloakEventType.OnAuthRefreshError\n            });\n        };\n        this._instance.onAuthSuccess = () => {\n            this._keycloakEvents$.next({ type: KeycloakEventType.OnAuthSuccess });\n        };\n        this._instance.onTokenExpired = () => {\n            this._keycloakEvents$.next({\n                type: KeycloakEventType.OnTokenExpired\n            });\n        };\n        this._instance.onActionUpdate = (state) => {\n            this._keycloakEvents$.next({\n                args: state,\n                type: KeycloakEventType.OnActionUpdate\n            });\n        };\n        this._instance.onReady = (authenticated) => {\n            this._keycloakEvents$.next({\n                args: authenticated,\n                type: KeycloakEventType.OnReady\n            });\n        };\n    }\n    loadExcludedUrls(bearerExcludedUrls) {\n        const excludedUrls = [];\n        for (const item of bearerExcludedUrls) {\n            let excludedUrl;\n            if (typeof item === 'string') {\n                excludedUrl = { urlPattern: new RegExp(item, 'i'), httpMethods: [] };\n            }\n            else {\n                excludedUrl = {\n                    urlPattern: new RegExp(item.url, 'i'),\n                    httpMethods: item.httpMethods\n                };\n            }\n            excludedUrls.push(excludedUrl);\n        }\n        return excludedUrls;\n    }\n    initServiceValues({ enableBearerInterceptor = true, loadUserProfileAtStartUp = false, bearerExcludedUrls = [], authorizationHeaderName = 'Authorization', bearerPrefix = 'Bearer', initOptions, updateMinValidity = 20, shouldAddToken = () => true, shouldUpdateToken = () => true }) {\n        this._enableBearerInterceptor = enableBearerInterceptor;\n        this._loadUserProfileAtStartUp = loadUserProfileAtStartUp;\n        this._authorizationHeaderName = authorizationHeaderName;\n        this._bearerPrefix = bearerPrefix.trim().concat(' ');\n        this._excludedUrls = this.loadExcludedUrls(bearerExcludedUrls);\n        this._silentRefresh = initOptions ? initOptions.flow === 'implicit' : false;\n        this._updateMinValidity = updateMinValidity;\n        this.shouldAddToken = shouldAddToken;\n        this.shouldUpdateToken = shouldUpdateToken;\n    }\n    async init(options = {}) {\n        this.initServiceValues(options);\n        const { config, initOptions } = options;\n        this._instance = new Keycloak(config);\n        this.bindsKeycloakEvents();\n        const authenticated = await this._instance.init(initOptions);\n        if (authenticated && this._loadUserProfileAtStartUp) {\n            await this.loadUserProfile();\n        }\n        return authenticated;\n    }\n    async login(options = {}) {\n        await this._instance.login(options);\n        if (this._loadUserProfileAtStartUp) {\n            await this.loadUserProfile();\n        }\n    }\n    async logout(redirectUri) {\n        const options = {\n            redirectUri\n        };\n        await this._instance.logout(options);\n        this._userProfile = undefined;\n    }\n    async register(options = { action: 'register' }) {\n        await this._instance.register(options);\n    }\n    isUserInRole(role, resource) {\n        let hasRole;\n        hasRole = this._instance.hasResourceRole(role, resource);\n        if (!hasRole) {\n            hasRole = this._instance.hasRealmRole(role);\n        }\n        return hasRole;\n    }\n    getUserRoles(allRoles = true) {\n        let roles = [];\n        if (this._instance.resourceAccess) {\n            for (const key in this._instance.resourceAccess) {\n                if (this._instance.resourceAccess.hasOwnProperty(key)) {\n                    const resourceAccess = this._instance.resourceAccess[key];\n                    const clientRoles = resourceAccess['roles'] || [];\n                    roles = roles.concat(clientRoles);\n                }\n            }\n        }\n        if (allRoles && this._instance.realmAccess) {\n            const realmRoles = this._instance.realmAccess['roles'] || [];\n            roles.push(...realmRoles);\n        }\n        return roles;\n    }\n    async isLoggedIn() {\n        if (!this._instance) {\n            return false;\n        }\n        return this._instance.authenticated;\n    }\n    isTokenExpired(minValidity = 0) {\n        return this._instance.isTokenExpired(minValidity);\n    }\n    async updateToken(minValidity = this._updateMinValidity) {\n        if (this._silentRefresh) {\n            if (this.isTokenExpired()) {\n                throw new Error('Failed to refresh the token, or the session is expired');\n            }\n            return true;\n        }\n        if (!this._instance) {\n            throw new Error('Keycloak Angular library is not initialized.');\n        }\n        try {\n            return await this._instance.updateToken(minValidity);\n        }\n        catch (error) {\n            return false;\n        }\n    }\n    async loadUserProfile(forceReload = false) {\n        if (this._userProfile && !forceReload) {\n            return this._userProfile;\n        }\n        if (!this._instance.authenticated) {\n            throw new Error('The user profile was not loaded as the user is not logged in.');\n        }\n        return (this._userProfile = await this._instance.loadUserProfile());\n    }\n    async getToken() {\n        return this._instance.token;\n    }\n    getUsername() {\n        if (!this._userProfile) {\n            throw new Error('User not logged in or user profile was not loaded.');\n        }\n        return this._userProfile.username;\n    }\n    clearToken() {\n        this._instance.clearToken();\n    }\n    addTokenToHeader(headers = new HttpHeaders()) {\n        return from(this.getToken()).pipe(map((token) => token\n            ? headers.set(this._authorizationHeaderName, this._bearerPrefix + token)\n            : headers));\n    }\n    getKeycloakInstance() {\n        return this._instance;\n    }\n    get excludedUrls() {\n        return this._excludedUrls;\n    }\n    get enableBearerInterceptor() {\n        return this._enableBearerInterceptor;\n    }\n    get keycloakEvents$() {\n        return this._keycloakEvents$;\n    }\n}\nKeycloakService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nKeycloakService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakService, decorators: [{\n            type: Injectable\n        }] });\n\nclass KeycloakBearerInterceptor {\n    constructor(keycloak) {\n        this.keycloak = keycloak;\n    }\n    async conditionallyUpdateToken(req) {\n        if (this.keycloak.shouldUpdateToken(req)) {\n            return await this.keycloak.updateToken();\n        }\n        return true;\n    }\n    isUrlExcluded({ method, url }, { urlPattern, httpMethods }) {\n        const httpTest = httpMethods.length === 0 ||\n            httpMethods.join().indexOf(method.toUpperCase()) > -1;\n        const urlTest = urlPattern.test(url);\n        return httpTest && urlTest;\n    }\n    intercept(req, next) {\n        const { enableBearerInterceptor, excludedUrls } = this.keycloak;\n        if (!enableBearerInterceptor) {\n            return next.handle(req);\n        }\n        const shallPass = !this.keycloak.shouldAddToken(req) ||\n            excludedUrls.findIndex((item) => this.isUrlExcluded(req, item)) > -1;\n        if (shallPass) {\n            return next.handle(req);\n        }\n        return combineLatest([\n            this.conditionallyUpdateToken(req),\n            this.keycloak.isLoggedIn()\n        ]).pipe(mergeMap(([_, isLoggedIn]) => isLoggedIn\n            ? this.handleRequestWithTokenHeader(req, next)\n            : next.handle(req)));\n    }\n    handleRequestWithTokenHeader(req, next) {\n        return this.keycloak.addTokenToHeader(req.headers).pipe(mergeMap((headersWithBearer) => {\n            const kcReq = req.clone({ headers: headersWithBearer });\n            return next.handle(kcReq);\n        }));\n    }\n}\nKeycloakBearerInterceptor.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakBearerInterceptor, deps: [{ token: KeycloakService }], target: i0.ɵɵFactoryTarget.Injectable });\nKeycloakBearerInterceptor.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakBearerInterceptor });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakBearerInterceptor, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: KeycloakService }]; } });\n\nclass CoreModule {\n}\nCoreModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: CoreModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nCoreModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"14.0.0\", version: \"15.0.1\", ngImport: i0, type: CoreModule, imports: [CommonModule] });\nCoreModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: CoreModule, providers: [\n        KeycloakService,\n        {\n            provide: HTTP_INTERCEPTORS,\n            useClass: KeycloakBearerInterceptor,\n            multi: true\n        }\n    ], imports: [CommonModule] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: CoreModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [CommonModule],\n                    providers: [\n                        KeycloakService,\n                        {\n                            provide: HTTP_INTERCEPTORS,\n                            useClass: KeycloakBearerInterceptor,\n                            multi: true\n                        }\n                    ]\n                }]\n        }] });\n\nclass KeycloakAngularModule {\n}\nKeycloakAngularModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakAngularModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nKeycloakAngularModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"14.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakAngularModule, imports: [CoreModule] });\nKeycloakAngularModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakAngularModule, imports: [CoreModule] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.0.1\", ngImport: i0, type: KeycloakAngularModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [CoreModule]\n                }]\n        }] });\n\nexport { CoreModule, KeycloakAngularModule, KeycloakAuthGuard, KeycloakBearerInterceptor, KeycloakEventType, KeycloakService };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}